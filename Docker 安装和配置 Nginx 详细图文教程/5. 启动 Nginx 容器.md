

## 5. 启动 Nginx 容器



使用以下命令在 Docker 中启动 Nginx 容器，并挂载自定义配置文件和网页文件：



```
docker run -it -d --restart always --network host \
  --name aioveu-nginx \
  -v /mnt/nginx/conf/nginx.conf:/etc/nginx/nginx.conf  \
  -v /mnt/nginx/html:/usr/share/nginx/html \
  -v /mnt/nginx/logs:/var/log/nginx/ \
  -v /mnt/nginx/ssl:/etc/nginx/ssl \
  nginx
  
 #/usr/share/nginx/html nginx配置文件的html路径要与映射路径一致
```



| **参数**                                         | **功能说明**   |
| ------------------------------------------------ | -------------- |
| **`--network host`**                             | 网络模式       |
| **`--name nginx`**                               | 容器命名       |
| **`-v [宿主机路径]:[容器路径]`**                 | 数据卷挂载     |
| /mnt/nginx/conf/nginx.conf:/etc/nginx/nginx.conf | 挂载主配置文件 |
| /mnt/nginx/html:/usr/share/nginx/html            | 挂载网站文件   |
| /mnt/nginx/logs:/var/log/nginx/                  | 持久化存储日志 |
| /mnt/nginx/ssl:/etc/nginx/ssl                    | 挂载SSL证书    |



![](F:\Coding\Github\aioveu-vue3-element-admin-doc\Docker 安装和配置 Nginx 详细图文教程\5.1.png)





1. **网络模式**：`--network host` → 容器直接使用宿主机的网络，没有端口映射问题，Nginx监听的端口直接暴露在宿主机上。
2. **网络模式**：`--network host`
   - 容器直接使用**宿主机网络栈**
   - **不需要端口映射**，Nginx 直接监听宿主机的 80/443 端口

### 访问步骤

由于使用 `host` 网络模式，Nginx 服务直接监听宿主机的端口（默认80和443），因此：

1. **通过HTTP访问**：在浏览器中输入宿主机的IP地址或域名（如 `http://<宿主机IP>`），默认使用80端口。
2. **通过HTTPS访问**：如果配置了SSL证书，使用 `https://<宿主机IP>` 访问，默认使用443端口。

### 如果无法访问，排查步骤：

1. **检查Nginx配置**：

   - 确保 `/mnt/nginx/nginx.conf` 配置文件正确，监听了正确的端口（默认为80和443）。

   - 在配置文件中查找指令：

     ```
     server {
         listen 80;
         # ...
     }
     ```

2.**检查网页文件目录**：

- 确保 `/mnt/nginx/html` 目录存在且包含网页文件（如 `index.html`）。
- 查看默认页面路径：`ls /mnt/nginx/html`

3.**检查端口占用**（`host`模式下端口直接暴露）：

- 在宿主机上检查80和443端口是否被其他进程占用：

  ```
  sudo lsof -i :80
  sudo lsof -i :443
  ```

- 如果有其他服务（如宿主机本身的Nginx/Apache）占用了这些端口，需要停止它们，或者修改容器中Nginx的监听端口。

### 重要提醒

- **自定义配置文件**：由于挂载了自定义的 `nginx.conf`，容器内部的默认配置已被覆盖，请确保配置中定义了`server`块来提供网页服务。
- **SSL证书**：如需HTTPS，需要在配置文件中设置SSL证书路径，并确保证书文件（如 `.crt` 和 `.key` 文件）已放入 `/mnt/nginx/ssl/` 目录。









或者在docker-compose文件中

```
  aioveu-nginx:
    image: nginx    #使用的镜像名称
    container_name: aioveu-nginx #给容器指定一个名称，方便以后引用。
    restart: unless-stopped
    #    build:
    #      context: .
    #      dockerfile: Dockerfile
    volumes:
#      - ./mnt/nginx/nginx.conf:/etc/nginx/nginx.conf   #挂载主配置文件
#      - ./mnt/nginx/html:/usr/share/nginx/html         #挂载网站文件
#      - ./mnt/nginx/logs:/var/log/nginx/               #持久化存储日志
#      - ./mnt/nginx/ssl:/etc/nginx/ssl                 #挂载SSL证书
      #
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf   #挂载主配置文件
      - ./nginx/html:/usr/share/nginx/html         #挂载网站文件
      - ./nginx/logs:/var/log/nginx/               #持久化存储日志
      - ./nginx/ssl:/etc/nginx/ssl                 #挂载SSL证书
      
    ports:
      - 80:80    #表示将nginx容器的80端口映射到宿主机的80端口。格式为宿主机端口:容器端口
    networks:
      - aioveu-boot
    depends_on:
      - mysql
```



```
docker-compose -f ./docker-compose.yml -p aioveu-boot up -d
```

